<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡πâ‡∏≤</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { font-family: "Kanit", sans-serif; }
    </style>
</head>
<body class="bg-blue-100 p-6">
    <div class="max-w-lg mx-auto bg-white p-6 rounded shadow">
        <h1 class="text-xl font-bold mb-4">üì∏ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡πâ‡∏≤</h1>
        <form id="uploadForm" method="POST" enctype="multipart/form-data" onsubmit="return validateUpload()">
            {% csrf_token %}
            
            <!-- ‚úÖ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå -->
            <div class="mb-4">
                <label for="skin_images" class="block text-gray-700">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡∏£‡∏π‡∏õ):</label>
                <input type="file" name="skin_images" id="skin_images" accept="image/*" multiple class="block w-full border rounded p-2">
                <p id="file-error" class="text-red-500 text-sm hidden">‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡∏£‡∏π‡∏õ</p>
            </div>
        
            <!-- ‚úÖ ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û -->
            <div class="mb-4">
                <label class="block text-gray-700">‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏•‡πâ‡∏≠‡∏á:</label>
                <video id="video" autoplay class="border rounded mb-2 max-w-full"></video>
                <canvas id="canvas" class="hidden"></canvas>
                <button type="button" id="capture" class="bg-blue-500 text-white px-4 py-2 rounded mb-2">üì∏ ‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û</button>
                <input type="hidden" name="captured_images" id="captured_images">
                <div id="previewContainer"></div> <!-- ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏π‡∏õ -->
            </div>
        
            <!-- ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡∏™‡πà‡∏á -->
            <button type="submit" class="bg-green-500 text-white px-4 py-2 rounded w-full">üì§ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î</button>
        </form>
        
        <script>
            const video = document.getElementById('video');
            const canvas = document.getElementById('canvas');
            const captureButton = document.getElementById('capture');
            const capturedInput = document.getElementById('captured_images');
            const fileInput = document.getElementById('skin_images');
            const previewContainer = document.getElementById('previewContainer');
            const fileError = document.getElementById('file-error');
        
            navigator.mediaDevices.getUserMedia({ video: true })
                .then(stream => {
                    video.srcObject = stream;
                })
                .catch(err => {
                    console.error("‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ:", err);
                });
        
            let capturedImages = [];
        
            captureButton.addEventListener('click', () => {
                const context = canvas.getContext('2d');
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                context.drawImage(video, 0, 0, canvas.width, canvas.height);
        
                const dataUrl = canvas.toDataURL('image/png');
                capturedImages.push(dataUrl);
                capturedInput.value = capturedImages.join(",");
        
                const imgElement = document.createElement('img');
                imgElement.src = dataUrl;
                imgElement.classList.add('border', 'rounded', 'max-w-full', 'mb-2');
                previewContainer.appendChild(imgElement);
            });
        
            function validateUpload() {
                let uploadedFiles = fileInput.files.length;
                let capturedCount = capturedImages.length;
                if ((uploadedFiles + capturedCount) < 2) {
                    fileError.classList.remove('hidden');
                    return false;
                }
                return true;
            }
        </script>        
</body>
</html>
